{
    "visualizations": {
        "viz_ZSRixqDn": {
            "type": "splunk.column",
            "dataSources": {
                "primary": "ds_wbVesmXh"
            },
            "title": "Customer Usage by Day"
        },
        "viz_gIUCw5mt": {
            "type": "splunk.column",
            "dataSources": {
                "primary": "ds_nKblrxxv"
            },
            "description": "More Detailed View",
            "title": "Usage by Division",
            "eventHandlers": [
                {
                    "type": "drilldown.customUrl",
                    "options": {
                        "url": "/app/sat_access/yl_-_l3_division_usage_deep-dive?form.customer_choice=$customer_choice|u$&amp;form.division_choice=$row.Division|u$&amp;form.field1.earliest=@y&amp;form.field1.latest=now",
                        "newTab": true
                    }
                }
            ]
        },
        "viz_9a6T4CcK": {
            "type": "splunk.line",
            "dataSources": {
                "primary": "ds_45adKhsI"
            },
            "title": "Usage Prediction"
        },
        "viz_4IkMyTP9": {
            "type": "splunk.singlevalue",
            "dataSources": {
                "primary": "ds_QREhCfHT"
            },
            "title": "Active Terminal Count"
        },
        "viz_hdsIAEfu": {
            "type": "splunk.column",
            "dataSources": {
                "primary": "ds_r31rGHY9"
            },
            "title": "Top 10 Circuits by Usage"
        }
    },
    "dataSources": {
        "ds_IPOc2QjL": {
            "type": "ds.search",
            "options": {
                "query": "| inputlookup satellite_circuit_lookup | dedup division | table division",
                "queryParameters": {
                    "earliest": "@y",
                    "latest": "now"
                }
            },
            "name": "Search_1"
        },
        "ds_wbVesmXh": {
            "type": "ds.search",
            "options": {
                "query": "index=sat_leo_starlink_prod \"billingCycles.dailyDataUsage.date\"=\"*\"\n            | spath output=UsageDate path=billingCycles.dailyDataUsage.date\n            | eval _time=strptime(UsageDate, \"%F\")\n            | stats max(billingCycles.dailyDataUsage.priorityGB) as priorityGB by serviceLineNumber, _time\n            | join type=left serviceLineNumber \n              [| search index=\"sat_leo_starlink_prod\" sourcetype=device_servicelines \"data.active\"=true \n              | spath output=\"serviceLineNumber\" path=data.serviceLineNumber \n              | spath output=\"nickname\" path=data.nickname\n              | fields serviceLineNumber nickname]\n            | lookup satellite_circuit_lookup local=true nickname OUTPUT customer_name, division\n            | search $customer_choice$ $division_choice$\n            | timechart span=1d sum(priorityGB) as \"Total Usage (GB)\"",
                "queryParameters": {
                    "earliest": "@y",
                    "latest": "now"
                }
            },
            "name": "Search_2"
        },
        "ds_nKblrxxv": {
            "type": "ds.search",
            "options": {
                "query": "index=sat_leo_starlink_prod \"billingCycles.dailyDataUsage.date\"=\"*\"\n            | stats max(billingCycles.dailyDataUsage.priorityGB) as priorityGB by serviceLineNumber\n            | join type=left serviceLineNumber \n              [| search index=\"sat_leo_starlink_prod\" sourcetype=device_servicelines \"data.active\"=true \n              | spath output=\"serviceLineNumber\" path=data.serviceLineNumber \n              | spath output=\"nickname\" path=data.nickname\n              | fields serviceLineNumber nickname]\n            | lookup satellite_circuit_lookup local=true nickname OUTPUT customer_name, division\n            | search $customer_choice$\n            | stats sum(priorityGB) as \"Total Usage (GB)\" by division\n            | rename division as \"Division\"",
                "queryParameters": {
                    "earliest": "@y",
                    "latest": "now"
                }
            },
            "name": "Search_3"
        },
        "ds_45adKhsI": {
            "type": "ds.search",
            "options": {
                "query": "index=sat_leo_starlink_prod \"billingCycles.dailyDataUsage.date\"=\"*\"\n            | spath output=UsageDate path=billingCycles.dailyDataUsage.date\n            | eval _time=strptime(UsageDate, \"%F\")\n            | stats max(billingCycles.dailyDataUsage.priorityGB) as priorityGB by serviceLineNumber, _time\n            | join type=left serviceLineNumber \n              [| search index=\"sat_leo_starlink_prod\" sourcetype=device_servicelines \"data.active\"=true \n              | spath output=\"serviceLineNumber\" path=data.serviceLineNumber \n              | spath output=\"nickname\" path=data.nickname\n              | fields serviceLineNumber nickname]\n            | lookup satellite_circuit_lookup local=true nickname OUTPUT customer_name\n            | search $customer_choice$\n            | timechart span=1d sum(priorityGB) as \"Actual Usage\"\n            | predict \"Actual Usage\" as prediction algorithm=LLP5 holdback=16 future_timespan=60 period=7 \n            | eval prediction=if(prediction < 0, 0, prediction)\n            | rename prediction as \"Predicted Usage\"\n            | eval \"Actual Usage\" = round('Actual Usage', 2), \"Predicted Usage\" = round('Predicted Usage', 2)\n            | timechart span=1d first(\"Actual Usage\") as \"Actual Usage\" first(\"Predicted Usage\") as \"Predicted Usage\"",
                "queryParameters": {
                    "earliest": "@y",
                    "latest": "now"
                }
            },
            "name": "Search_4"
        },
        "ds_QREhCfHT": {
            "type": "ds.search",
            "options": {
                "query": "index=sat_leo_starlink_prod sourcetype=\"device_terminals\"\n            | spath path=data{}.userTerminalId output=userterminal\n            | spath path=data{}.serviceLineNumber output=servicelinenumber\n            | spath path=data{}.active output=terminal_active\n            | where servicelinenumber!=\"null\" AND terminal_active=\"true\"\n            | dedup userterminal\n            | rename servicelinenumber as serviceLineNumber\n            | join serviceLineNumber type=left\n              [| search index=\"sat_leo_starlink_prod\" sourcetype=device_servicelines \"data.active\"=true\n              | spath output=\"serviceLineNumber\" path=data.serviceLineNumber\n              | spath output=\"nickname\" path=data.nickname\n              | fields serviceLineNumber nickname]\n            | lookup satellite_circuit_lookup local=true nickname OUTPUT customer_name\n            | search $customer_choice$\n            | stats count",
                "queryParameters": {
                    "earliest": "@y",
                    "latest": "now"
                }
            },
            "name": "Search_5"
        },
        "ds_r31rGHY9": {
            "type": "ds.search",
            "options": {
                "query": "index=sat_leo_starlink_prod \"billingCycles.dailyDataUsage.date\"=\"*\"\n        | spath output=totalPriorityGBytes path=billingCycles.totalPriorityGB\n        | stats max(totalPriorityGBytes) as priorityGB by serviceLineNumber\n        | join type=left serviceLineNumber\n          [| search index=\"sat_leo_starlink_prod\" sourcetype=device_servicelines \"data.active\"=true\n          | spath output=\"serviceLineNumber\" path=data.serviceLineNumber\n          | spath output=\"nickname\" path=data.nickname\n          | fields serviceLineNumber nickname]\n        | lookup satellite_circuit_lookup local=true nickname OUTPUT customer_name, circuit_alias\n        | search $customer_choice$\n        | where isnotnull(nickname) AND isnotnull(circuit_alias)\n        | sort 10 - priorityGB\n        | rename circuit_alias as \"Circuit Alias\", priorityGB as \"Usage (GB)\", nickname as \" \"\n        | table \"Circuit Alias\", \"Usage (GB)\", \" \"",
                "queryParameters": {
                    "earliest": "@y",
                    "latest": "now"
                }
            },
            "name": "Search_6"
        },
        "ds_n2xtNNom": {
            "type": "ds.search",
            "options": {
                "query": "| inputlookup satellite_circuit_lookup | dedup customer_name | table customer_name",
                "queryParameters": {
                    "earliest": "@y",
                    "latest": "now"
                }
            },
            "name": "Search_7"
        }
    },
    "defaults": {
        "dataSources": {
            "ds.search": {
                "options": {
                    "queryParameters": {
                        "latest": "$global_time.latest$",
                        "earliest": "$global_time.earliest$"
                    }
                }
            }
        }
    },
    "inputs": {
        "input_mrgi3pU7": {
            "options": {
                "items": ">frame(label, value) | prepend(formattedStatics) | objects()",
                "defaultValue": "*",
                "token": "division_choice"
            },
            "title": "Select Division",
            "type": "input.dropdown",
            "dataSources": {
                "primary": "ds_IPOc2QjL"
            },
            "context": {
                "formattedConfig": {
                    "number": {
                        "prefix": ""
                    }
                },
                "formattedStatics": ">statics | formatByType(formattedConfig)",
                "statics": [
                    [
                        "All"
                    ],
                    [
                        "*"
                    ]
                ],
                "label": ">primary | seriesByName(\"division\") | renameSeries(\"label\") | formatByType(formattedConfig)",
                "value": ">primary | seriesByName(\"division\") | renameSeries(\"value\") | formatByType(formattedConfig)"
            }
        },
        "input_RRYPj2rN": {
            "options": {
                "items": ">frame(label, value) | prepend(formattedStatics) | objects()",
                "defaultValue": "*",
                "token": "customer_choice"
            },
            "title": "Select Customer",
            "type": "input.dropdown",
            "dataSources": {
                "primary": "ds_n2xtNNom"
            },
            "context": {
                "formattedConfig": {
                    "number": {
                        "prefix": ""
                    }
                },
                "formattedStatics": ">statics | formatByType(formattedConfig)",
                "statics": [
                    [
                        "All"
                    ],
                    [
                        "*"
                    ]
                ],
                "label": ">primary | seriesByName(\"customer_name\") | renameSeries(\"label\") | formatByType(formattedConfig)",
                "value": ">primary | seriesByName(\"customer_name\") | renameSeries(\"value\") | formatByType(formattedConfig)"
            }
        }
    },
    "layout": {
        "type": "absolute",
        "options": {
            "width": 1440,
            "height": 960,
            "display": "fit-to-width"
        },
        "structure": [
            {
                "item": "viz_ZSRixqDn",
                "type": "block",
                "position": {
                    "x": 0,
                    "y": 0,
                    "w": 710,
                    "h": 300
                }
            },
            {
                "item": "viz_gIUCw5mt",
                "type": "block",
                "position": {
                    "x": 720,
                    "y": 0,
                    "w": 720,
                    "h": 300
                }
            },
            {
                "item": "viz_9a6T4CcK",
                "type": "block",
                "position": {
                    "x": 0,
                    "y": 310,
                    "w": 1440,
                    "h": 300
                }
            },
            {
                "item": "viz_4IkMyTP9",
                "type": "block",
                "position": {
                    "x": 0,
                    "y": 620,
                    "w": 710,
                    "h": 300
                }
            },
            {
                "item": "viz_hdsIAEfu",
                "type": "block",
                "position": {
                    "x": 720,
                    "y": 620,
                    "w": 720,
                    "h": 300
                }
            }
        ],
        "globalInputs": [
            "input_RRYPj2rN",
            "input_mrgi3pU7"
        ]
    },
    "description": "",
    "title": "YL - L2 Customer Hub Dashboard"
}
