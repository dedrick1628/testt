def _log_execution_step(self, rule_dict: Dict[str, Any], action: str, 
                       input_data: Any = None, output_data: Any = None,
                       error_message: str = None, message_type: str = "INFO",
                       action_status: str = "SUCCESS") -> None:
        """Log execution step to database"""
        try:
            # Prepare data for logging
            rule_id = rule_dict.get('rule_id', '')
            rule_name = rule_dict.get('rule_name', '')
            step_id = rule_dict.get('rule_step_number', '')
            
            # Get Intent Type (from your previous update)
            intent_type = self.current_context.get('intent_type', rule_dict.get('intent_type', ''))
            
            # --- NEW CODE START ---
            # Get MTN List from context and convert to string for logging
            mtn_data = self.current_context.get('mtn_list')
            mtn_log_value = str(mtn_data) if mtn_data else ''
            # --- NEW CODE END ---

            # Convert complex data to JSON strings
            input_json = json.dumps(input_data, default=str) if input_data else None
            output_json = json.dumps(output_data, default=str) if output_data else None

            # Generate LOG_ID using timestamp + random number
            log_id = int(datetime.now().strftime('%Y%m%d%H%M%S%f')[:-3]) + random.randint(1, 999)

            # UPDATED SQL QUERY TO INCLUDE MTN
            insert_sql = """
                INSERT INTO CXP_OPS_MONITORING.CXP_STORE_SUPPORT_EXECUTION_LOG_NP (
                    LOG_ID, RULE_ID, SESSION_ID, RULE_NAME, ORDER_NUMBER, 
                    LOCATION_CODE, STEP_ID, STEP_NAME, ACTION, INPUT_DATA, 
                    OUTPUT_DATA, ERROR_MESSAGE, MESSAGE_TYPE, ACTION_STATUS, 
                    INTENT_TYPE, MTN, CREATED_DATE
                ) VALUES (
                    :log_id, :rule_id, :session_id, :rule_name, :order_number,
                    :location_code, :step_id, :step_name, :action, :input_data,
                    :output_data, :error_message, :message_type, :action_status, 
                    :intent_type, :mtn, SYSTIMESTAMP
                )
            """

            self.cursor.execute(insert_sql, {
                'log_id': log_id,
                'rule_id': rule_id,
                'session_id': self.session_id,
                'rule_name': rule_name,
                'order_number': self.current_context.get('order_number', ''),
                'location_code': self.current_context.get('location_code', ''),
                'step_id': str(step_id),
                'step_name': rule_name,
                'action': action,
                'input_data': input_json,
                'output_data': output_json,
                'error_message': error_message,
                'message_type': message_type,
                'action_status': action_status,
                'intent_type': intent_type,
                'mtn': mtn_log_value  # <-- Added new parameter here
            })

            self.connection.commit()

            print(f"ðŸ“ LOGGED: {action} for {rule_name} (Session: {self.session_id})")

        except Exception as e:
            print(f"âŒ Logging error: {str(e)}")
            # Don't fail the main process due to logging issues
            pass
